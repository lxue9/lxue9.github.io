<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta property="og:image" content="https://www.stevesplayground.online/game/1000words_logo.png" />
    <meta property="og:title" content="Welcome to Steve's playgroundï¼" />
    <meta property="og:description" content="A game site developed by Steve and his mom." />
    <meta property="og:url" content="https://www.stevesplayground.online/game/1000words/" />
    <meta property="og:type" content="website" />

    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <title>English Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://www.stevesplayground.online/game/1000words/vocabulary.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');
        body { 
            font-family: 'Nunito', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            background: #fcfcfd; color: #1e293b; margin: 0; padding: 0;
            overflow-x: hidden; touch-action: pan-y;
        }
        
        /* 1. æµ®å‹• Emoji å‹•ç•« */
        @keyframes emoji-jump { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-50px); } }
        .floating-emoji { display: inline-block; animation: emoji-jump 0.5s ease-in-out infinite; }

        /* 2. é»ƒé‡‘é›¨ç‰¹æ•ˆèƒŒæ™¯ */
        .gold-glow { box-shadow: 0 0 50px rgba(255, 215, 0, 0.4); border: 4px solid #FFD700 !important; }

        .floating-nav { 
            position: fixed; bottom: 24px; left: 20px; right: 20px; 
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.5); border-radius: 32px; 
            z-index: 100; padding: 12px; box-shadow: 0 15px 35px -5px rgba(0,0,0,0.1);
        }
        .modal-overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: center; z-index: 500; padding: 20px; }
        .card-inner { transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); transform-style: preserve-3d; height: 420px; width: 100%; max-width: 340px; margin: 0 auto; position: relative; }
        .flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 48px; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 2rem; box-shadow: 0 10px 30px rgba(0,0,0,0.04); border: 10px solid white; }
        .card-back { background: #6366F1; color: white; transform: rotateY(180deg); }
        .btn-active { transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .btn-active:active { transform: scale(0.95); opacity: 0.8; }
        .badge { position: absolute; top: -6px; right: -6px; background: #fb7185; color: white; font-size: 10px; font-weight: 900; padding: 2px 8px; border-radius: 10px; border: 2px solid white; }
        .swipe-hint { position: absolute; bottom: -40px; font-size: 12px; font-weight: 900; color: #cbd5e1; display: flex; gap: 20px; }

		@keyframes slow-float {
 		 0%, 100% { transform: translateY(0); }
  		50% { transform: translateY(-5px); } /* å‘ä¸Šæ¼‚æµ® 5px */
		}

		.animate-float {
 			 animation: slow-float 3s ease-in-out infinite;
  			display: inline-flex; /* ç¡®ä¿åŠ¨ç”»åº”ç”¨åœ¨è¡Œå†…å—ä¸Š */
		}
		
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // å…¨å±€å™´æ³‰/é»ƒé‡‘é›¨å‡½æ•¸
        window.fireSuccessConfetti = (isGoldRain = false) => {
            if (typeof confetti !== 'function') return;
            const duration = isGoldRain ? 10 * 1000 : 2.5 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 1000 };
            const randomInRange = (min, max) => Math.random() * (max - min) + min;

            const interval = setInterval(() => {
                const timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                const particleCount = isGoldRain ? 100 : 50;
                const colors = isGoldRain ? ['#FFD700', '#FFA500', '#FF8C00', '#FAE64D'] : undefined;
                confetti({ ...defaults, particleCount, colors, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } });
                confetti({ ...defaults, particleCount, colors, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } });
            }, 250);
        };

        const App = () => {
            const [view, setView] = useState('menu');
            const [currentLevel, setCurrentLevel] = useState('1');
            const [idx, setIdx] = useState(0);
            const [flipped, setFlipped] = useState(false);
            const [testFeedback, setTestFeedback] = useState(null);
            const [isChecking, setIsChecking] = useState(false);
            const [userName, setUserName] = useState(() => localStorage.getItem('steve_name') || '');
            const [showNameModal, setShowNameModal] = useState(!localStorage.getItem('steve_name'));
            const [tempName, setTempName] = useState(localStorage.getItem('steve_name') || '');
            
            const [learnedWords, setLearnedWords] = useState(() => JSON.parse(localStorage.getItem('steve_learned') || '[]'));
            const [wrongWords, setWrongWords] = useState(() => JSON.parse(localStorage.getItem('steve_wrong') || '[]'));
            const [highScore, setHighScore] = useState(() => parseInt(localStorage.getItem('steve_highscore')) || 0);
            
            // 3. æ‰“å¡å¤©æ•¸ä¿®å¾©é‚è¼¯
            const [streak, setStreak] = useState(() => parseInt(localStorage.getItem('steve_streak')) || 0);

            const [isChallenge, setIsChallenge] = useState(false);
            const [isWrongSetMode, setIsWrongSetMode] = useState(false);
            const [currentList, setCurrentList] = useState([]);
            const [score, setScore] = useState(0);
            const [showGameOver, setShowGameOver] = useState(false);

            const touchStart = useRef(null);
            const audioRefs = {
                wrong: useRef(new Audio('https://www.stevesplayground.online/game/1000words/wrong.mp3')),
                correct: useRef(new Audio('https://www.stevesplayground.online/game/1000words/correct.mp3')),
                finish: useRef(new Audio('https://www.stevesplayground.online/game/1000words/finish.mp3'))
            };

			// è‡ªåŠ¨è¯†åˆ«å¹¶æ¸²æŸ“ Emoji æˆ– å›¾ç‰‡
			const renderMedia = (source, sizeClass = "text-[120px]") => {
 				 if (!source) return null;
				const strSource = String(source).trim();
  				const isImage = strSource.includes('/') || strSource.includes('.');

 				 if (isImage) {
   					 return (
    				  /* ä¸ºå›¾ç‰‡å®¹å™¨æ·»åŠ ä¸ Emoji ç›¸åŒçš„åŠ¨ç”»ç±» animate-float */
     				 <div className="w-[120px] h-[120px] flex items-center justify-center animate-float">
       					 <img 
          					src={strSource} 
					        className="max-w-full max-h-full object-contain pointer-events-none" 
          					style={{ filter: 'drop-shadow(0 4px 6px rgba(0,0,0,0.1))' }} 
        				/>
     				 </div>
   					 );
 				 }

  			// Emoji é€»è¾‘
			
			const emojiCount = Array.from(strSource).length;	
  			const fontSize = emojiCount > 4 ? '60px' : (emojiCount > 2 ? '80px' : '120px');
 			 return (
    			/* ç»Ÿä¸€ä½¿ç”¨ animate-float ä»£æ›¿åŸæ¥çš„ floating-emoji */
    			<span className="animate-float transition-all duration-300" style={{ fontSize, lineHeight: '1' }}>
      				{strSource}
    			</span>
 				 );
			};
			
            const dbData = window.DB || (typeof DB !== 'undefined' ? DB : null);
            const fullList = useMemo(() => {
                if (!dbData) return [];
                let all = [];
                Object.values(dbData).forEach(lvl => { all = all.concat(Object.keys(lvl.words)); });
                return all;
            }, [dbData]);

            const [shuffledOptions, setShuffledOptions] = useState([]);
            const currentKey = currentList[idx];

            // 4. è‡ªå‹•è¨ˆç®—æ‰“å¡å¤©æ•¸
            useEffect(() => {
                const lastDate = localStorage.getItem('steve_last_date');
                const today = new Date().toDateString();
                
                if (lastDate !== today) {
                    const newStreak = streak + 1;
                    setStreak(newStreak);
                    localStorage.setItem('steve_streak', newStreak.toString());
                    localStorage.setItem('steve_last_date', today);
                }
            }, []);

            // ç›£è½ç”Ÿå­˜æ¨¡å¼çµæŸè§¸ç™¼é»ƒé‡‘é›¨
            useEffect(() => {
                if (showGameOver) {
                    const isMaster = isChallenge && score >= 1000;
                    window.fireSuccessConfetti(isMaster);
                }
            }, [showGameOver, isChallenge, score]);

            const speak = (text) => {
                if (!text) return;
                window.speechSynthesis.cancel();
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = 'en-US';
                utter.rate = 1.0;
                window.speechSynthesis.speak(utter);
            };

            const playSound = (type) => {
                const sound = audioRefs[type].current;
                if (sound) { sound.currentTime = 0; sound.play().catch(()=>{}); }
            };

            const handleTouchStart = (e) => { touchStart.current = e.touches[0].clientX; };
            const handleTouchEnd = (e) => {
                if (!touchStart.current || view !== 'card') return;
                const distance = touchStart.current - e.changedTouches[0].clientX;
                if (distance > 50) handleNext();
                else if (distance < -50) handlePrev();
                touchStart.current = null;
            };

            const handleNext = () => {
                if (idx < currentList.length - 1) {
                    setFlipped(false);
                    setIdx(prev => prev + 1);
                } else {
		    // æœ€åä¸€é¢˜ç­”å®Œ
                    playSound('finish');
                    setShowGameOver(true);
                }
            };

            const handlePrev = () => { if (idx > 0) { setFlipped(false); setIdx(prev => prev - 1); } };

            const resetProgress = () => {
                if (confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰é€²åº¦å—ï¼Ÿæ‰“å¡å¤©æ•¸ä¹Ÿå°‡æ­¸é›¶ã€‚")) {
                    setLearnedWords([]); setWrongWords([]); setHighScore(0); setStreak(0);
                    localStorage.clear();
                    window.location.reload();
                }
            };

            useEffect(() => {
                localStorage.setItem('steve_learned', JSON.stringify(learnedWords));
                localStorage.setItem('steve_wrong', JSON.stringify(wrongWords));
                localStorage.setItem('steve_highscore', highScore.toString());
            }, [learnedWords, wrongWords, highScore]);

            useEffect(() => {
                if (currentKey && fullList.length > 0) {
                    const distractors = fullList.filter(k => k !== currentKey).sort(() => 0.5 - Math.random()).slice(0, 3);
                    setShuffledOptions([currentKey, ...distractors].sort(() => 0.5 - Math.random()));
                    setTestFeedback(null);
                }
            }, [currentKey, currentList, fullList]);

            const handleChoice = (choice) => {
                if (testFeedback) return;
                if (choice === currentKey) {
                    speak(currentKey);
                    setTestFeedback('correct');
                    if (isChallenge) setScore(s => s + 1);
                    if (isWrongSetMode) setWrongWords(prev => prev.filter(w => w !== currentKey));
                    if (!learnedWords.includes(currentKey)) setLearnedWords(prev => [...prev, currentKey]);
                    setTimeout(() => {
                        setTestFeedback(null);
                        if (idx < currentList.length - 1) setIdx(idx + 1);
                        else {
                            if (isChallenge) {
                                const nextWord = fullList[Math.floor(Math.random() * fullList.length)];
                                setCurrentList(prev => [...prev, nextWord]);
                                setIdx(idx + 1);
                            } else { playSound('finish'); setShowGameOver(true); }
                        }
                    }, 800);
                } else {
                    setTestFeedback('wrong'); playSound('wrong');
                    if (!wrongWords.includes(currentKey)) setWrongWords(prev => [...prev, currentKey]);
                    if (isChallenge) {
                        setTimeout(() => {
                            if (score > highScore) setHighScore(score);
                            playSound('finish'); setShowGameOver(true);
                        }, 600);
                    } else { setTimeout(() => setTestFeedback(null), 600); }
                }
            };

            const startMode = (mode, levelId = '1') => {
		// 1. åˆå§‹åŒ–æ‰€æœ‰çŠ¶æ€
                setIsChallenge(false); 
		setIsWrongSetMode(false); 
		setIdx(0); // ç¡®ä¿ä»ç¬¬ä¸€ä¸ªå•è¯å¼€å§‹
		setFlipped(false); 
		setTestFeedback(null);
		setShowGameOver(false); // ç¡®ä¿å…³é—­ç»“ç®—å¼¹çª—

		if (!dbData || !dbData[levelId]) return;

                playSound('correct');
                if (mode === 'card') {
		// è·å–è¯¥å…³å¡æ‰€æœ‰å•è¯
        	    const allWords = Object.keys(dbData[levelId].words);
		// è¿‡æ»¤æ‰å·²å­¦ä¼šçš„
        	    const toLearn = allWords.filter(k => !learnedWords.includes(k));

		// å¦‚æœå…¨å­¦å®Œäº†ï¼Œå°±å¤ä¹ å…¨éƒ¨ï¼Œå¦åˆ™åªå­¦æ²¡å­¦ä¼šçš„
        	    setCurrentList(toLearn.length > 0 ? toLearn : allWords);

                    setCurrentLevel(levelId); 
		    setView('card');

                } else if (mode === 'test') {
                    setCurrentList(Object.keys(dbData[levelId].words));
                    setCurrentLevel(levelId); setView('test');
                } else if (mode === 'survival') {
                    setIsChallenge(true); setScore(0);
                    setCurrentList([fullList[Math.floor(Math.random() * fullList.length)]]);
                    setView('test');
                } else if (mode === 'wrong') {
                    if (wrongWords.length === 0) return alert('ç›®å‰æ²’æœ‰éŒ¯é¡Œï¼');
                    setIsWrongSetMode(true);
                    setCurrentList([...wrongWords].sort(() => Math.random() - 0.5));
                    setView('test');
                }
            };

            if (view === 'menu') {
                return (
                    <div className="max-w-md mx-auto p-6 relative">
                        {showNameModal && (
                            <div className="modal-overlay">
                                <div className="bg-white p-6 rounded-[48px] text-center w-full max-w-[340px] shadow-2xl">
                                    <h2 className="text-[22px] font-black mb-6 whitespace-nowrap tracking-tight">Hello! What's your name?</h2>
                                    <input type="text" value={tempName} onChange={(e) => setTempName(e.target.value)} placeholder="Steve..." className="w-full bg-slate-50 border-2 border-slate-100 rounded-3xl py-4 px-6 mb-6 font-black text-center outline-none focus:border-indigo-200" />
                                    <button onClick={() => { setUserName(tempName); localStorage.setItem('steve_name', tempName); setShowNameModal(false); playSound('correct'); }} className="w-full bg-indigo-600 text-white py-5 rounded-[28px] font-black btn-active">Let's Go!</button>
                                </div>
                            </div>
                        )}
                        <header className="flex justify-between items-center mb-8 px-2 pt-4">
                            <div>
                                <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Welcome back</p>
                                <h1 className="text-2xl font-black text-slate-800 tracking-tight">
                                    <span className="text-indigo-600">{userName || 'Steve'}'s</span> English Master
                                </h1>
                            </div>
                            <button onClick={resetProgress} className="bg-white border border-slate-100 px-3 py-1 rounded-full text-[10px] font-black text-slate-400 shadow-sm btn-active uppercase">Reset</button>
                        </header>
                        
                        <div className="grid grid-cols-3 gap-3 mb-10">
                            <div className="bg-white p-4 rounded-3xl border border-slate-50 shadow-sm text-center">
                                <p className="text-[10px] font-black text-slate-300 uppercase mb-1">å·²å­¸æœƒ</p>
                                <p className="text-xl font-black text-indigo-600">{learnedWords.length} ğŸ“–</p>
                            </div>
                            <div className="bg-white p-4 rounded-3xl border border-slate-50 shadow-sm text-center">
                                <p className="text-[10px] font-black text-slate-300 uppercase mb-1">æœ€é«˜åˆ†</p>
                                <p className="text-xl font-black text-slate-700">{highScore} ğŸ†</p>
                            </div>
                            <div className="bg-white p-4 rounded-3xl border border-slate-50 shadow-sm text-center">
                                <p className="text-[10px] font-black text-slate-300 uppercase mb-1">æ‰“å¡å¤©æ•¸</p>
                                <p className="text-xl font-black text-emerald-500">{streak} ğŸ”¥</p>
                            </div>
                        </div>

                        <div className="space-y-4">
                            {dbData && Object.entries(dbData).map(([id, data]) => {
                                const total = Object.keys(data.words).length;
                                const done = Object.keys(data.words).filter(w => learnedWords.includes(w)).length;
                                return (
                                    <div key={id} className="bg-white p-5 rounded-[36px] border border-slate-50 flex items-center shadow-sm overflow-hidden">
                                        <div className="w-14 h-14 shrink-0 bg-indigo-50/50 rounded-2xl flex items-center justify-center text-3xl mr-4 relative">{data.levelEmoji}</div>
                                        <div className="flex-1">
                                            <h3 className="font-black text-slate-700 text-base">{data.levelName}</h3>
                                            <div className="flex items-center gap-3 mt-2">
                                                <div className="flex-1 bg-slate-100 h-2 rounded-full overflow-hidden">
                                                    <div className="bg-indigo-400 h-full transition-all duration-1000" style={{width: `${(done/total)*100}%`}}></div>
                                                </div>
                                                <span className="text-[10px] font-black text-slate-400">{done}/{total}</span>
                                            </div>
                                        </div>
                                        <div className="flex gap-2 ml-4">
                                            <button onClick={() => startMode('card', id)} className="w-11 h-11 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-md btn-active">ğŸ“–</button>
                                            <button onClick={() => startMode('test', id)} className="w-11 h-11 bg-slate-100 text-slate-600 rounded-2xl flex items-center justify-center btn-active">ğŸ•¹ï¸</button>
                                        </div>
                                    </div>
                                );
                            })}
                            <div style={{ height: '220px' }}></div>
                        </div>
                        
                        <nav className="floating-nav flex gap-3 max-w-md mx-auto">
                            <button onClick={() => startMode('survival')} className="flex-1 bg-indigo-50/80 text-indigo-700 h-[64px] rounded-[24px] btn-active flex items-center justify-center gap-2">
                                <div className="w-8 h-8 bg-indigo-600 text-white rounded-xl flex items-center justify-center text-xs shadow-sm">âš¡</div>
                                <div className="text-left"><p className="text-[10px] font-black uppercase opacity-60 leading-none">å…¨é‡æŒ‘æˆ°</p><p className="text-[13px] font-black leading-none mt-1">ç”Ÿå­˜æ¨¡å¼</p></div>
                            </button>
                            <button onClick={() => startMode('wrong')} className="flex-1 bg-slate-50/80 text-slate-700 h-[64px] rounded-[24px] btn-active flex items-center justify-center gap-2 relative">
                                {wrongWords.length > 0 && <span className="badge">{wrongWords.length}</span>}
                                <div className="w-8 h-8 bg-slate-200 text-slate-600 rounded-xl flex items-center justify-center text-xs">ğŸ“•</div>
                                <div className="text-left"><p className="text-[10px] font-black uppercase opacity-60 leading-none">éå›ºç·´ç¿’</p><p className="text-[13px] font-black leading-none mt-1">æˆ‘çš„éŒ¯é¡Œ</p></div>
                            </button>
                        </nav>
                    </div>
                );
            }

            const wordInfo = dbData && currentKey ? (Object.values(dbData).find(l => l.words[currentKey])?.words[currentKey]) : null;

            return (
                <div className="max-w-md mx-auto h-screen flex flex-col p-6 bg-white overflow-hidden" onTouchStart={handleTouchStart} onTouchEnd={handleTouchEnd}>
                    <header className="flex justify-between items-center mb-6">
                        <button onClick={() => setView('menu')} className="bg-slate-50 px-5 py-2.5 rounded-full font-black text-slate-400 text-[11px] uppercase border border-slate-100 btn-active">â† è¿”å›</button>
                        <div className="text-[11px] font-black text-slate-400 uppercase tracking-widest">
                            {isChallenge ? `å¾—åˆ†: ${score}` : (isWrongSetMode ? `éŒ¯é¡Œå¾©ç¿’` : `ç­‰ç´š ${currentLevel}`)} â€¢ {idx + 1}/{currentList.length}
                        </div>
                        <div className="w-12"></div>
                    </header>
                    <div className="flex-1 flex flex-col items-center justify-center relative">
                        {wordInfo && (
                            view === 'card' ? (
                                <div className="w-full flex flex-col items-center">
                                    <div className={`card-inner ${flipped ? 'flipped' : ''}`} onClick={() => setFlipped(!flipped)}>
                                        <div className="card-face bg-white border-slate-50">
                                           
											{/* ç»Ÿä¸€å®¹å™¨ï¼šé«˜åº¦å›ºå®šåœ¨ 130px å·¦å³ */}
                                            <div 
        										className="h-32 mb-4 flex items-end justify-center select-none cursor-pointer"
       											 onClick={(e) => { e.stopPropagation(); speak(currentKey); }}
    											>
       											 {renderMedia(wordInfo[0])}
    										</div>

  											  <div className="text-5xl font-black text-slate-800 uppercase tracking-tighter">
        										{currentKey}
   											 </div>

                                            <button onClick={(e) => { e.stopPropagation(); speak(currentKey); }} className="mt-8 w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center text-2xl btn-active border border-slate-100">ğŸ”Š</button>
                                        </div>
                                        <div className="card-face card-back">
                                            <div className="text-4xl font-black mb-2 text-center px-4">{wordInfo[1]}</div>
                                            <div className="text-indigo-100 text-sm italic mb-8 opacity-80">{wordInfo[2]}</div>
                                            <div onClick={(e) => { e.stopPropagation(); speak(wordInfo[3]); }} className="bg-white/10 p-6 rounded-[32px] mb-8 italic text-sm leading-relaxed text-center border border-white/10 cursor-pointer">
                                                "{wordInfo[3]}"
                                            </div>
                                            <button onClick={(e) => { 
                                                e.stopPropagation(); setIsChecking(true); playSound('correct');
                                                setTimeout(() => { 
                                                    if (!learnedWords.includes(currentKey)) setLearnedWords(prev => [...prev, currentKey]);
                                                    setFlipped(false); setIsChecking(false); handleNext();
                                                }, 800);
                                            }} className={`mt-8 w-20 h-20 rounded-full border-4 border-white flex items-center justify-center btn-active ${isChecking ? 'bg-emerald-400 border-emerald-400 scale-110' : 'bg-white/20'}`}>
                                                <svg className="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="4" d="M5 13l4 4L19 7"/></svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div className="swipe-hint"><span>â† æ»‘å‹•ä¸‹å€‹</span><span>å›çœ‹ä¸Šå€‹ â†’</span></div>
                                </div>
                            ) : (
                                <div className="w-full px-4 text-center">
                                    {/* åŠ¨æ€è®¡ç®—å­—å·ï¼š1ä¸ªEmojiç”¨120pxï¼Œ2ä¸ªç”¨80pxï¼Œ3ä¸ªåŠä»¥ä¸Šç”¨60px */}
                                            <div 
        										className="h-32 mb-16 flex items-end justify-center select-none cursor-pointer"
        										onClick={(e) => { e.stopPropagation(); speak(currentKey); }}
                                                >
                                                  {renderMedia(wordInfo[0])}
                                            </div>
                                   			<div className="grid grid-cols-2 gap-4">
												
                                        {shuffledOptions.map((opt, i) => (
                                            <button key={`${currentKey}-${opt}-${i}`} onClick={() => handleChoice(opt)}
                                                className={`p-6 rounded-[32px] font-black text-lg border-b-[6px] transition-all btn-active ${
                                                    testFeedback === 'correct' && opt === currentKey ? 'bg-emerald-500 text-white border-emerald-700' :
                                                    testFeedback === 'wrong' && opt !== currentKey ? 'bg-rose-50 text-rose-300 border-rose-100' : 
                                                    (testFeedback === 'wrong' && opt === currentKey ? 'bg-emerald-100 text-emerald-500 border-emerald-200' : 'bg-white text-slate-600 border-slate-100 shadow-sm')
                                                }`}
                                            >{opt}</button>
                                        ))}
                                    </div>
                                </div>
                            )
                        )}
                    </div>

                    {showGameOver && (
                        <div className="fixed inset-0 bg-slate-900/80 backdrop-blur-md flex items-center justify-center z-[200] p-6 text-slate-800">
                            <div className={`bg-white p-10 rounded-[56px] text-center w-full max-w-[380px] shadow-2xl transform transition-all ${score >= 1000 ? 'gold-glow' : ''}`}>
                                {isChallenge && score >= 1000 ? (
                                    <>
                                        <div className="text-8xl mb-6 floating-emoji">ğŸ‘‘</div>
                                        <h2 className="text-2xl font-black mb-4 tracking-tight leading-tight">
                                            Congratulations, <span className="text-yellow-500">{userName || 'Steve'}</span>!
                                        </h2>
                                        <p className="text-slate-600 font-bold mb-8 leading-relaxed">
                                            ç¥è³€ä½ åœ¨ <span className="text-emerald-500 text-xl">{streak}</span> å¤©å…§å®Œæˆäº† <span className="text-indigo-600 text-xl">1000è©</span> å¤§æŒ‘æˆ°ï¼
                                        </p>
                                    </>
                                ) : (
                                    <>
                                        <div className="text-8xl mb-6">
                                            {isChallenge ? (score > highScore ? "ğŸ†" : "ğŸ‰") : "âœ…"}
                                        </div>
                                        <h2 className="text-2xl font-black mb-2">
                                            {isChallenge ? (score > highScore ? "æ‰“ç ´ç´€éŒ„!" : "å¤ªæ£’äº†!") : "å­¸ç¿’å®Œæˆ!"}
                                        </h2>
                                        <div className="mb-8">
                                            {isChallenge ? (
                                                <p className="font-black text-slate-400 text-lg uppercase tracking-widest">
                                                    Score: {score}
                                                </p>
                                            ) : (
                                                <div className="flex flex-col items-center gap-2">
                                                    <p className="font-black text-slate-400 text-sm uppercase tracking-widest">
                                                        æœ¬è¼ªé€²åº¦
                                                    </p>
                                                    <p className="text-3xl font-black text-indigo-600">
                                                        {idx + 1} / {currentList.length}
                                                    </p>
                                                    <p className="text-[11px] font-bold text-slate-400">
                                                        Words Mastered
                                                    </p>
                                                </div>
                                            )}
                                        </div>
                                    </>
                                )}
                                <button onClick={() => { setShowGameOver(false); setView('menu'); setIdx(0); }} className="w-full bg-slate-900 text-white py-5 rounded-[28px] font-black btn-active shadow-lg">å›åˆ°é¦–é </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

